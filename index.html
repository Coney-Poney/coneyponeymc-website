<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Coney Poney MC Server</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link href="index.css" rel="stylesheet">
</head>

<body>

    <script src="darkmode.js"></script>
    <div class="bg-image">
        <div> </div>
        <ul class="nav nav-underline justify-content-center my-2">
            <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="index.html">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="rules.html">Rules</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="gallery.html">Gallery</a>
            </li>
        </ul>

        <div class="container text-center">
            <div class="row justify-content-center">
                <div class="col-5">
                    <img src="coneyponey.png" class="img-fluid" alt="Coney Poney Logo">
                </div>
            </div>
            <div class="row overflow-auto">
                <div class="col-sm my-3">
                    <div class="card" id="mc.shebang.gay">
                        <span
                            class="position-absolute top-0 start-100 translate-middle p-2 bg-secondary border border-light rounded-circle"
                            title="Offline">
                            <span class="visually-hidden"></span>
                        </span>
                        <a href="https://mcmap.shebang.gay"><img class="card-img-top" src="survival.png"
                                alt="mc.shebang.gay" title="View Online Map"></a>
                        <div class="card-body">
                            <h5 class="card-title">Survival</h5>
                            <h6 class="text-secondary card-subtitle">mc.shebang.gay</h3>
                        </div>
                    </div>
                </div>
                <div class="col-sm my-3">
                    <div class="card" id="cmc.shebang.gay">
                        <span
                            class="position-absolute top-0 start-100 translate-middle p-2 bg-secondary border border-light rounded-circle"
                            title="Offline">
                            <span class="visually-hidden"></span>
                        </span>
                        <a href="https://cmcmap.shebang.gay"><img class="card-img-top" src="creative.png"
                                alt="mc.shebang.gay" title="View Online Map"></a>
                        <div class="card-body">
                            <h5 class="card-title">Creative</h5>
                            <h6 class="text-secondary card-subtitle">cmc.shebang.gay</h3>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row w-50 mx-auto my-3">
                <div class="card">

                    <div class="card-body">

                        <h5 class="card-title">Player Count</h5>
                        <div class="progress" role="progressbar" aria-label="Example with label" aria-valuenow="25"
                            aria-valuemin="0" aria-valuemax="100">
                            <div class="progress-bar" style="width: 0%"></div>
                        </div>
                        <h5 class="my-1" id="playercount">?/40</h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="container" height="">
            <footer class="my-4">
                <p class="text-center text-secondary">Coney Poney (CC BY 4.0)</p>
            </footer>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
    <script src=" https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js "></script>
    <script>
        urls = ["mc.shebang.gay", "cmc.shebang.gay"]

        $(document).ready(function () {
            for (const element of urls) {
                fetchAsync(element)
                    .then(data => onlineSet(data))
                    .catch(reason => console.log(reason.message))
            }
        });

        function onlineSet(data) {
            if (data.online = true) {
                document.getElementById(data.host).getElementsByTagName("span")[0].classList.remove('bg-secondary');
                document.getElementById(data.host).getElementsByTagName("span")[0].classList.add('bg-success');
                document.getElementById(data.host).getElementsByTagName("span")[0].title = "Online";
                if (document.getElementById("playercount").innerText = "?/40") {
                    let progressbar = document.getElementById("playercount").parentNode;
                    console.log(progressbar)
                    progressbar.querySelectorAll("#playercount")[0].innerText = data.players.online + "/" + data.players.max
                    progressbar.querySelectorAll('div')[0].querySelectorAll('div')[0].style = "width:" + (data.players.online * 2.5) + "%"
                }
            }
        }

        async function fetchAsync(url) {
            const response = await fetch("https://api.mcstatus.io/v2/status/java/" + url);
            return await response.json();
        }
    </script>
</body>

</html>